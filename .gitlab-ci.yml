image: hypriot/rpi-alpine-scratch:latest
before_script:
  - apk update
  - apk upgrade
  - apk add elixir
  - mix deps.get
stages:
  - check_style
  - test
  - coverage
  - build

test:
  stage: test
  script:
    - mix test

check_style:
  stage: check_style
  allow_failure: true
  script:
    - mix credo
    - mix dogma

coveralls:
  stage: coverage
  allow_failure: true
  script:
    - mix coveralls

build:
  script: mix escript.build
  artifacts:
    paths:
      - build
